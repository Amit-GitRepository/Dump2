Object.defineProperty(exports,"__esModule",{value:true});var cov_hl2ugzyz5=function(){var path='/Users/amitkumar/iTrueService/DevCode/iservice-app/app/redux/sagas/invoicePdf.saga.js',hash='87ec929be39864c872eb1fcfaf43d3d8d86cf83e',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/amitkumar/iTrueService/DevCode/iservice-app/app/redux/sagas/invoicePdf.saga.js',statementMap:{'0':{start:{line:11,column:22},end:{line:11,column:56}},'1':{start:{line:12,column:23},end:{line:12,column:64}},'2':{start:{line:15,column:22},end:{line:23,column:3}},'3':{start:{line:24,column:2},end:{line:24,column:21}},'4':{start:{line:28,column:22},end:{line:28,column:36}},'5':{start:{line:29,column:22},end:{line:29,column:59}},'6':{start:{line:30,column:2},end:{line:34,column:3}},'7':{start:{line:31,column:4},end:{line:31,column:43}},'8':{start:{line:33,column:4},end:{line:33,column:47}},'9':{start:{line:38,column:17},end:{line:41,column:3}},'10':{start:{line:42,column:2},end:{line:42,column:81}},'11':{start:{line:46,column:2},end:{line:59,column:3}},'12':{start:{line:47,column:20},end:{line:54,column:9}},'13':{start:{line:55,column:21},end:{line:55,column:91}},'14':{start:{line:56,column:4},end:{line:56,column:89}},'15':{start:{line:58,column:4},end:{line:58,column:71}},'16':{start:{line:63,column:2},end:{line:63,column:51}}},fnMap:{'0':{name:'getRequestData',decl:{start:{line:14,column:17},end:{line:14,column:31}},loc:{start:{line:14,column:44},end:{line:25,column:1}},line:14},'1':{name:'getInvoicePdf',decl:{start:{line:27,column:17},end:{line:27,column:30}},loc:{start:{line:27,column:40},end:{line:35,column:1}},line:27},'2':{name:'getInvoiceIos',decl:{start:{line:37,column:17},end:{line:37,column:30}},loc:{start:{line:37,column:45},end:{line:43,column:1}},line:37},'3':{name:'getInvoiceAndroid',decl:{start:{line:45,column:17},end:{line:45,column:34}},loc:{start:{line:45,column:49},end:{line:60,column:1}},line:45},'4':{name:'invoicePdfSaga',decl:{start:{line:62,column:25},end:{line:62,column:39}},loc:{start:{line:62,column:43},end:{line:64,column:1}},line:62}},branchMap:{'0':{loc:{start:{line:30,column:2},end:{line:34,column:3}},type:'if',locations:[{start:{line:30,column:2},end:{line:34,column:3}},{start:{line:30,column:2},end:{line:34,column:3}}],line:30}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0},b:{'0':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();exports.












getRequestData=getRequestData;exports.












getInvoicePdf=getInvoicePdf;exports.









getInvoiceIos=getInvoiceIos;exports.







getInvoiceAndroid=getInvoiceAndroid;exports.default=
















invoicePdfSaga;var _reactNativeConfig=require('react-native-config');var _reactNativeConfig2=_interopRequireDefault(_reactNativeConfig);var _apiEndpoints=require('../../config/apiEndpoints.json');var _apiEndpoints2=_interopRequireDefault(_apiEndpoints);var _reactNativeFetchBlob=require('react-native-fetch-blob');var _reactNativeFetchBlob2=_interopRequireDefault(_reactNativeFetchBlob);var _effects=require('redux-saga/effects');var _index=require('../actions/index.actions');var _common=require('../../utils/common.util');var _reactNavigation=require('react-navigation');var _reactNative=require('../../utils/reactNative.util');var _helper=require('../../language/i18n/helper');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _marked=regeneratorRuntime.mark(getRequestData),_marked2=regeneratorRuntime.mark(getInvoicePdf),_marked3=regeneratorRuntime.mark(getInvoiceIos),_marked4=regeneratorRuntime.mark(getInvoiceAndroid),_marked5=regeneratorRuntime.mark(invoicePdfSaga);var icardSelector=(cov_hl2ugzyz5.s[0]++,(0,_common.getSelector)('user.profile.idcard'));var msisdnSelector=(cov_hl2ugzyz5.s[1]++,(0,_common.getSelector)('user.profile.trueid.mobile'));function getRequestData(invoiceNo){var requestData;return regeneratorRuntime.wrap(function getRequestData$(_context){while(1){switch(_context.prev=_context.next){case 0:cov_hl2ugzyz5.f[0]++;cov_hl2ugzyz5.s[2]++;_context.t0='Bearer '+_reactNativeConfig2.default.ISERVICE_AUTH_TOKEN;_context.next=5;return(0,_effects.select)(icardSelector);case 5:_context.t1=_context.sent;_context.t2=''+_context.t1;_context.next=9;return(0,_effects.select)(msisdnSelector);case 9:_context.t3=_context.sent;_context.t4=''+_context.t3;_context.t5={'Authorization':_context.t0,'icard':_context.t2,'msisdn':_context.t4};_context.t6=''+_reactNativeConfig2.default.SUBSCRIBER_ENDPOINT+_apiEndpoints2.default.GET_INVOICE_PDF+'/'+invoiceNo;_context.t7=invoiceNo;requestData={headers:_context.t5,url:_context.t6,invoiceNo:_context.t7};cov_hl2ugzyz5.s[3]++;return _context.abrupt('return',requestData);case 17:case'end':return _context.stop();}}},_marked,this);}function getInvoicePdf(action){var _ref,invoiceNo,requestData;return regeneratorRuntime.wrap(function getInvoicePdf$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:cov_hl2ugzyz5.f[1]++;_ref=(cov_hl2ugzyz5.s[4]++,action.payload),invoiceNo=_ref.invoiceNo;cov_hl2ugzyz5.s[5]++;_context2.next=5;return(0,_effects.call)(getRequestData,invoiceNo);case 5:requestData=_context2.sent;cov_hl2ugzyz5.s[6]++;if(!(_reactNative.Platform.OS==='ios')){_context2.next=14;break;}cov_hl2ugzyz5.b[0][0]++;cov_hl2ugzyz5.s[7]++;_context2.next=12;return(0,_effects.call)(getInvoiceIos,requestData);case 12:_context2.next=18;break;case 14:cov_hl2ugzyz5.b[0][1]++;cov_hl2ugzyz5.s[8]++;_context2.next=18;return(0,_effects.call)(getInvoiceAndroid,requestData);case 18:case'end':return _context2.stop();}}},_marked2,this);}function getInvoiceIos(requestData){var params;return regeneratorRuntime.wrap(function getInvoiceIos$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:cov_hl2ugzyz5.f[2]++;params=(cov_hl2ugzyz5.s[9]++,{url:requestData.url,headers:requestData.headers});cov_hl2ugzyz5.s[10]++;_context3.next=5;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({routeName:'PackagePromoPage',params:params}));case 5:case'end':return _context3.stop();}}},_marked3,this);}function getInvoiceAndroid(requestData){var request,response;return regeneratorRuntime.wrap(function getInvoiceAndroid$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:cov_hl2ugzyz5.f[3]++;cov_hl2ugzyz5.s[11]++;_context4.prev=2;cov_hl2ugzyz5.s[12]++;_context4.next=6;return(0,_effects.call)(_reactNativeFetchBlob2.default.config,{addAndroidDownloads:{useDownloadManager:true,notification:true,mime:'application/pdf',mediaScannable:true,title:'invoice-'+requestData.invoiceNo+'.pdf',path:_reactNativeFetchBlob2.default.fs.dirs.DownloadDir+('/invoice-'+requestData.invoiceNo+'.pdf')}});case 6:request=_context4.sent;cov_hl2ugzyz5.s[13]++;_context4.next=10;return(0,_effects.call)(request.fetch,'GET',requestData.url,requestData.headers);case 10:response=_context4.sent;cov_hl2ugzyz5.s[14]++;_context4.next=14;return(0,_effects.call)(_reactNativeFetchBlob2.default.android.actionViewIntent,response.path(),'application/pdf');case 14:_context4.next=20;break;case 16:_context4.prev=16;_context4.t0=_context4['catch'](2);cov_hl2ugzyz5.s[15]++;_reactNative.Toast.show((0,_helper.translate)('BILLS_USAGE_PDF_DOWNLOAD_FAIL'),_reactNative.Toast.LONG);case 20:case'end':return _context4.stop();}}},_marked4,this,[[2,16]]);}function invoicePdfSaga(){return regeneratorRuntime.wrap(function invoicePdfSaga$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:cov_hl2ugzyz5.f[4]++;cov_hl2ugzyz5.s[16]++;_context5.next=4;return(
(0,_effects.takeLatest)(_index.GET_INVOICE_PDF,getInvoicePdf));case 4:case'end':return _context5.stop();}}},_marked5,this);}