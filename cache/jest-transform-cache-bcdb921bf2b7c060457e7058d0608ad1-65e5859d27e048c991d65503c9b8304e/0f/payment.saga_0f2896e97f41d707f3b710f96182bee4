Object.defineProperty(exports,"__esModule",{value:true});var cov_z5whf2qsf=function(){var path='/Users/amitkumar/iTrueService/DevCode/iservice-app/app/redux/sagas/payment.saga.js',hash='39800e9e418fc0bb764688f77159eef7fcff5c3c',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/Users/amitkumar/iTrueService/DevCode/iservice-app/app/redux/sagas/payment.saga.js',statementMap:{'0':{start:{line:13,column:2},end:{line:32,column:3}},'1':{start:{line:14,column:18},end:{line:14,column:63}},'2':{start:{line:15,column:37},end:{line:15,column:44}},'3':{start:{line:16,column:20},end:{line:16,column:54}},'4':{start:{line:17,column:27},end:{line:17,column:87}},'5':{start:{line:18,column:21},end:{line:18,column:78}},'6':{start:{line:19,column:4},end:{line:22,column:8}},'7':{start:{line:23,column:4},end:{line:23,column:74}},'8':{start:{line:25,column:4},end:{line:31,column:5}},'9':{start:{line:26,column:6},end:{line:29,column:10}},'10':{start:{line:30,column:6},end:{line:30,column:76}},'11':{start:{line:36,column:2},end:{line:54,column:3}},'12':{start:{line:37,column:37},end:{line:37,column:44}},'13':{start:{line:38,column:20},end:{line:38,column:54}},'14':{start:{line:39,column:27},end:{line:39,column:61}},'15':{start:{line:40,column:21},end:{line:40,column:72}},'16':{start:{line:41,column:4},end:{line:44,column:8}},'17':{start:{line:45,column:4},end:{line:45,column:74}},'18':{start:{line:47,column:4},end:{line:53,column:5}},'19':{start:{line:48,column:6},end:{line:51,column:10}},'20':{start:{line:52,column:6},end:{line:52,column:76}},'21':{start:{line:58,column:2},end:{line:84,column:3}},'22':{start:{line:59,column:18},end:{line:59,column:63}},'23':{start:{line:60,column:69},end:{line:60,column:76}},'24':{start:{line:61,column:4},end:{line:75,column:5}},'25':{start:{line:62,column:27},end:{line:62,column:92}},'26':{start:{line:63,column:6},end:{line:68,column:7}},'27':{start:{line:64,column:8},end:{line:64,column:70}},'28':{start:{line:66,column:37},end:{line:66,column:71}},'29':{start:{line:67,column:8},end:{line:67,column:65}},'30':{start:{line:69,column:23},end:{line:69,column:85}},'31':{start:{line:70,column:6},end:{line:73,column:10}},'32':{start:{line:74,column:6},end:{line:74,column:76}},'33':{start:{line:77,column:4},end:{line:83,column:5}},'34':{start:{line:78,column:6},end:{line:81,column:10}},'35':{start:{line:82,column:6},end:{line:82,column:76}},'36':{start:{line:88,column:2},end:{line:94,column:3}},'37':{start:{line:89,column:18},end:{line:89,column:63}},'38':{start:{line:90,column:4},end:{line:90,column:48}},'39':{start:{line:91,column:4},end:{line:91,column:45}},'40':{start:{line:93,column:4},end:{line:93,column:65}},'41':{start:{line:98,column:2},end:{line:109,column:3}},'42':{start:{line:99,column:19},end:{line:99,column:64}},'43':{start:{line:100,column:46},end:{line:100,column:71}},'44':{start:{line:101,column:4},end:{line:101,column:117}},'45':{start:{line:102,column:26},end:{line:102,column:73}},'46':{start:{line:103,column:18},end:{line:103,column:50}},'47':{start:{line:104,column:24},end:{line:104,column:70}},'48':{start:{line:105,column:4},end:{line:105,column:32}},'49':{start:{line:107,column:4},end:{line:107,column:70}},'50':{start:{line:108,column:4},end:{line:108,column:16}},'51':{start:{line:112,column:2},end:{line:126,column:3}},'52':{start:{line:113,column:24},end:{line:113,column:38}},'53':{start:{line:114,column:21},end:{line:114,column:72}},'54':{start:{line:115,column:21},end:{line:115,column:34}},'55':{start:{line:116,column:4},end:{line:116,column:57}},'56':{start:{line:117,column:4},end:{line:123,column:5}},'57':{start:{line:118,column:6},end:{line:118,column:82}},'58':{start:{line:119,column:11},end:{line:123,column:5}},'59':{start:{line:120,column:6},end:{line:120,column:75}},'60':{start:{line:122,column:6},end:{line:122,column:78}},'61':{start:{line:125,column:4},end:{line:125,column:68}},'62':{start:{line:130,column:2},end:{line:142,column:3}},'63':{start:{line:131,column:37},end:{line:131,column:44}},'64':{start:{line:132,column:31},end:{line:132,column:69}},'65':{start:{line:133,column:26},end:{line:133,column:58}},'66':{start:{line:134,column:31},end:{line:134,column:74}},'67':{start:{line:135,column:4},end:{line:138,column:5}},'68':{start:{line:136,column:25},end:{line:136,column:86}},'69':{start:{line:137,column:6},end:{line:137,column:72}},'70':{start:{line:139,column:4},end:{line:139,column:64}},'71':{start:{line:146,column:2},end:{line:153,column:3}},'72':{start:{line:147,column:18},end:{line:147,column:63}},'73':{start:{line:148,column:16},end:{line:148,column:53}},'74':{start:{line:149,column:23},end:{line:149,column:46}},'75':{start:{line:150,column:4},end:{line:150,column:41}},'76':{start:{line:152,column:4},end:{line:152,column:69}},'77':{start:{line:157,column:2},end:{line:157,column:61}},'78':{start:{line:158,column:2},end:{line:158,column:60}},'79':{start:{line:159,column:2},end:{line:159,column:70}},'80':{start:{line:160,column:2},end:{line:160,column:62}},'81':{start:{line:161,column:2},end:{line:161,column:60}},'82':{start:{line:162,column:2},end:{line:162,column:64}},'83':{start:{line:163,column:2},end:{line:163,column:98}}},fnMap:{'0':{name:'paymentForNewCustomer',decl:{start:{line:12,column:17},end:{line:12,column:38}},loc:{start:{line:12,column:51},end:{line:33,column:1}},line:12},'1':{name:'paymentForNonLoginUser',decl:{start:{line:35,column:17},end:{line:35,column:39}},loc:{start:{line:35,column:52},end:{line:55,column:1}},line:35},'2':{name:'paymentForExistingCustomer',decl:{start:{line:57,column:17},end:{line:57,column:43}},loc:{start:{line:57,column:56},end:{line:85,column:1}},line:57},'3':{name:'removeExisingCard',decl:{start:{line:87,column:17},end:{line:87,column:34}},loc:{start:{line:87,column:47},end:{line:95,column:1}},line:87},'4':{name:'getCardToken',decl:{start:{line:97,column:10},end:{line:97,column:22}},loc:{start:{line:97,column:70},end:{line:110,column:1}},line:97},'5':{name:'fetchPayOtherProducts',decl:{start:{line:111,column:17},end:{line:111,column:38}},loc:{start:{line:111,column:48},end:{line:127,column:1}},line:111},'6':{name:'payOtherProductToggleCollapseStatus',decl:{start:{line:129,column:17},end:{line:129,column:52}},loc:{start:{line:129,column:65},end:{line:143,column:1}},line:129},'7':{name:'showPaymentMethods',decl:{start:{line:145,column:17},end:{line:145,column:35}},loc:{start:{line:145,column:39},end:{line:154,column:1}},line:145},'8':{name:'paymentSaga',decl:{start:{line:156,column:26},end:{line:156,column:37}},loc:{start:{line:156,column:41},end:{line:164,column:1}},line:156}},branchMap:{'0':{loc:{start:{line:25,column:4},end:{line:31,column:5}},type:'if',locations:[{start:{line:25,column:4},end:{line:31,column:5}},{start:{line:25,column:4},end:{line:31,column:5}}],line:25},'1':{loc:{start:{line:25,column:8},end:{line:25,column:46}},type:'binary-expr',locations:[{start:{line:25,column:8},end:{line:25,column:13}},{start:{line:25,column:17},end:{line:25,column:46}}],line:25},'2':{loc:{start:{line:47,column:4},end:{line:53,column:5}},type:'if',locations:[{start:{line:47,column:4},end:{line:53,column:5}},{start:{line:47,column:4},end:{line:53,column:5}}],line:47},'3':{loc:{start:{line:47,column:8},end:{line:47,column:46}},type:'binary-expr',locations:[{start:{line:47,column:8},end:{line:47,column:13}},{start:{line:47,column:17},end:{line:47,column:46}}],line:47},'4':{loc:{start:{line:61,column:4},end:{line:75,column:5}},type:'if',locations:[{start:{line:61,column:4},end:{line:75,column:5}},{start:{line:61,column:4},end:{line:75,column:5}}],line:61},'5':{loc:{start:{line:63,column:6},end:{line:68,column:7}},type:'if',locations:[{start:{line:63,column:6},end:{line:68,column:7}},{start:{line:63,column:6},end:{line:68,column:7}}],line:63},'6':{loc:{start:{line:77,column:4},end:{line:83,column:5}},type:'if',locations:[{start:{line:77,column:4},end:{line:83,column:5}},{start:{line:77,column:4},end:{line:83,column:5}}],line:77},'7':{loc:{start:{line:77,column:8},end:{line:77,column:46}},type:'binary-expr',locations:[{start:{line:77,column:8},end:{line:77,column:13}},{start:{line:77,column:17},end:{line:77,column:46}}],line:77},'8':{loc:{start:{line:117,column:4},end:{line:123,column:5}},type:'if',locations:[{start:{line:117,column:4},end:{line:123,column:5}},{start:{line:117,column:4},end:{line:123,column:5}}],line:117},'9':{loc:{start:{line:119,column:11},end:{line:123,column:5}},type:'if',locations:[{start:{line:119,column:11},end:{line:123,column:5}},{start:{line:119,column:11},end:{line:123,column:5}}],line:119},'10':{loc:{start:{line:119,column:15},end:{line:119,column:68}},type:'binary-expr',locations:[{start:{line:119,column:15},end:{line:119,column:34}},{start:{line:119,column:38},end:{line:119,column:68}}],line:119},'11':{loc:{start:{line:135,column:4},end:{line:138,column:5}},type:'if',locations:[{start:{line:135,column:4},end:{line:138,column:5}},{start:{line:135,column:4},end:{line:138,column:5}}],line:135}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[typeof Symbol==='function'?Symbol.iterator:'@@iterator'](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if((typeof Symbol==='function'?Symbol.iterator:'@@iterator')in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};exports.










paymentForNewCustomer=paymentForNewCustomer;exports.






















paymentForNonLoginUser=paymentForNonLoginUser;exports.





















paymentForExistingCustomer=paymentForExistingCustomer;exports.





























removeExisingCard=removeExisingCard;exports.























fetchPayOtherProducts=fetchPayOtherProducts;exports.

















payOtherProductToggleCollapseStatus=payOtherProductToggleCollapseStatus;exports.















showPaymentMethods=showPaymentMethods;exports.default=










paymentSaga;var _api=require('./api/api.saga');var _api2=_interopRequireDefault(_api);var _result=require('lodash/result');var _result2=_interopRequireDefault(_result);var _apiHelper=require('./api/apiHelper');var _effects=require('redux-saga/effects');var _payment=require('../../config/payment.config');var _index=require('../actions/index.actions');var _common=require('../../utils/common.util');var _reactNavigation=require('react-navigation');var _reactNative=require('../../utils/reactNative.util');var _helper=require('../../language/i18n/helper');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _marked=regeneratorRuntime.mark(paymentForNewCustomer),_marked2=regeneratorRuntime.mark(paymentForNonLoginUser),_marked3=regeneratorRuntime.mark(paymentForExistingCustomer),_marked4=regeneratorRuntime.mark(removeExisingCard),_marked5=regeneratorRuntime.mark(getCardToken),_marked6=regeneratorRuntime.mark(fetchPayOtherProducts),_marked7=regeneratorRuntime.mark(payOtherProductToggleCollapseStatus),_marked8=regeneratorRuntime.mark(showPaymentMethods),_marked9=regeneratorRuntime.mark(paymentSaga);function paymentForNewCustomer(_ref){var payload=_ref.payload;var ssoID,_ref2,paymentItems,formData,_ref3,token,requestPayload,response;return regeneratorRuntime.wrap(function paymentForNewCustomer$(_context){while(1){switch(_context.prev=_context.next){case 0:cov_z5whf2qsf.f[0]++;cov_z5whf2qsf.s[0]++;_context.prev=2;cov_z5whf2qsf.s[1]++;_context.next=6;return(0,_effects.select)((0,_common.getSelector)('user.profile.uid'));case 6:ssoID=_context.sent;_ref2=(cov_z5whf2qsf.s[2]++,payload),paymentItems=_ref2.paymentItems,formData=_ref2.formData;cov_z5whf2qsf.s[3]++;_context.next=11;return(0,_effects.call)(getCardToken,formData);case 11:_ref3=_context.sent;token=_ref3.token;requestPayload=(cov_z5whf2qsf.s[4]++,{payables:paymentItems,saveCard:formData.saveCard,token:token});cov_z5whf2qsf.s[5]++;_context.next=17;return(0,_effects.call)(_api2.default,(0,_apiHelper.payForNewCustomer)(ssoID,requestPayload));case 17:response=_context.sent;cov_z5whf2qsf.s[6]++;_context.next=21;return(0,_effects.put)((0,_index.setPaymentStatus)({status:_payment.PAYMENT_STATUS.SUCCESS,details:response.body}));case 21:cov_z5whf2qsf.s[7]++;_context.next=24;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({'routeName':'PaymentStatus'}));case 24:_context.next=40;break;case 26:_context.prev=26;_context.t0=_context['catch'](2);cov_z5whf2qsf.s[8]++;if(!((cov_z5whf2qsf.b[1][0]++,_context.t0)&&(cov_z5whf2qsf.b[1][1]++,_context.t0.code!=='invalid_card'))){_context.next=39;break;}cov_z5whf2qsf.b[0][0]++;cov_z5whf2qsf.s[9]++;_context.next=34;return(0,_effects.put)((0,_index.setPaymentStatus)({status:_payment.PAYMENT_STATUS.FAIL,details:{message:(0,_result2.default)(_context.t0,'message')}}));case 34:cov_z5whf2qsf.s[10]++;_context.next=37;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({'routeName':'PaymentStatus'}));case 37:_context.next=40;break;case 39:cov_z5whf2qsf.b[0][1]++;case 40:case'end':return _context.stop();}}},_marked,this,[[2,26]]);}function paymentForNonLoginUser(_ref4){var payload=_ref4.payload;var _ref5,paymentItems,formData,_ref6,token,requestPayload,response;return regeneratorRuntime.wrap(function paymentForNonLoginUser$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:cov_z5whf2qsf.f[1]++;cov_z5whf2qsf.s[11]++;_context2.prev=2;_ref5=(cov_z5whf2qsf.s[12]++,payload),paymentItems=_ref5.paymentItems,formData=_ref5.formData;cov_z5whf2qsf.s[13]++;_context2.next=7;return(0,_effects.call)(getCardToken,formData);case 7:_ref6=_context2.sent;token=_ref6.token;requestPayload=(cov_z5whf2qsf.s[14]++,{payables:paymentItems[0],token:token});cov_z5whf2qsf.s[15]++;_context2.next=13;return(0,_effects.call)(_api2.default,(0,_apiHelper.payForNonLoginUser)(requestPayload));case 13:response=_context2.sent;cov_z5whf2qsf.s[16]++;_context2.next=17;return(0,_effects.put)((0,_index.setPaymentStatus)({status:_payment.PAYMENT_STATUS.SUCCESS,details:response.body}));case 17:cov_z5whf2qsf.s[17]++;_context2.next=20;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({'routeName':'PaymentStatus'}));case 20:_context2.next=36;break;case 22:_context2.prev=22;_context2.t0=_context2['catch'](2);cov_z5whf2qsf.s[18]++;if(!((cov_z5whf2qsf.b[3][0]++,_context2.t0)&&(cov_z5whf2qsf.b[3][1]++,_context2.t0.code!=='invalid_card'))){_context2.next=35;break;}cov_z5whf2qsf.b[2][0]++;cov_z5whf2qsf.s[19]++;_context2.next=30;return(0,_effects.put)((0,_index.setPaymentStatus)({status:_payment.PAYMENT_STATUS.FAIL,details:{message:(0,_result2.default)(_context2.t0,'message')}}));case 30:cov_z5whf2qsf.s[20]++;_context2.next=33;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({'routeName':'PaymentStatus'}));case 33:_context2.next=36;break;case 35:cov_z5whf2qsf.b[2][1]++;case 36:case'end':return _context2.stop();}}},_marked2,this,[[2,22]]);}function paymentForExistingCustomer(_ref7){var payload=_ref7.payload;var ssoID,_ref8,type,customerId,paymentItems,formData,selectedCard,requestPayload,_ref9,token,fingerprint,response;return regeneratorRuntime.wrap(function paymentForExistingCustomer$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:cov_z5whf2qsf.f[2]++;cov_z5whf2qsf.s[21]++;_context3.prev=2;cov_z5whf2qsf.s[22]++;_context3.next=6;return(0,_effects.select)((0,_common.getSelector)('user.profile.uid'));case 6:ssoID=_context3.sent;_ref8=(cov_z5whf2qsf.s[23]++,payload),type=_ref8.type,customerId=_ref8.customerId,paymentItems=_ref8.paymentItems,formData=_ref8.formData,selectedCard=_ref8.selectedCard;cov_z5whf2qsf.s[24]++;if(!customerId){_context3.next=40;break;}cov_z5whf2qsf.b[4][0]++;requestPayload=(cov_z5whf2qsf.s[25]++,{payables:paymentItems,customerId:customerId,saveCard:formData.saveCard});cov_z5whf2qsf.s[26]++;if(!(type===_payment.CARD_TYPE.SAVED)){_context3.next=19;break;}cov_z5whf2qsf.b[5][0]++;cov_z5whf2qsf.s[27]++;requestPayload=_extends({},requestPayload,{cardID:selectedCard.id});_context3.next=28;break;case 19:cov_z5whf2qsf.b[5][1]++;cov_z5whf2qsf.s[28]++;_context3.next=23;return(0,_effects.call)(getCardToken,formData);case 23:_ref9=_context3.sent;token=_ref9.token;fingerprint=_ref9.fingerprint;cov_z5whf2qsf.s[29]++;requestPayload=_extends({},requestPayload,{token:token,fingerprint:fingerprint});case 28:cov_z5whf2qsf.s[30]++;_context3.next=31;return(0,_effects.call)(_api2.default,(0,_apiHelper.payForExistingCustomer)(ssoID,requestPayload));case 31:response=_context3.sent;cov_z5whf2qsf.s[31]++;_context3.next=35;return(0,_effects.put)((0,_index.setPaymentStatus)({status:_payment.PAYMENT_STATUS.SUCCESS,details:response.body}));case 35:cov_z5whf2qsf.s[32]++;_context3.next=38;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({'routeName':'PaymentStatus'}));case 38:_context3.next=41;break;case 40:cov_z5whf2qsf.b[4][1]++;case 41:_context3.next=57;break;case 43:_context3.prev=43;_context3.t0=_context3['catch'](2);cov_z5whf2qsf.s[33]++;if(!((cov_z5whf2qsf.b[7][0]++,_context3.t0)&&(cov_z5whf2qsf.b[7][1]++,_context3.t0.code!=='invalid_card'))){_context3.next=56;break;}cov_z5whf2qsf.b[6][0]++;cov_z5whf2qsf.s[34]++;_context3.next=51;return(0,_effects.put)((0,_index.setPaymentStatus)({status:_payment.PAYMENT_STATUS.FAIL,details:{message:(0,_result2.default)(_context3.t0,'message')}}));case 51:cov_z5whf2qsf.s[35]++;_context3.next=54;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({'routeName':'PaymentStatus'}));case 54:_context3.next=57;break;case 56:cov_z5whf2qsf.b[6][1]++;case 57:case'end':return _context3.stop();}}},_marked3,this,[[2,43]]);}function removeExisingCard(_ref10){var payload=_ref10.payload;var ssoID;return regeneratorRuntime.wrap(function removeExisingCard$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:cov_z5whf2qsf.f[3]++;cov_z5whf2qsf.s[36]++;_context4.prev=2;cov_z5whf2qsf.s[37]++;_context4.next=6;return(0,_effects.select)((0,_common.getSelector)('user.profile.uid'));case 6:ssoID=_context4.sent;cov_z5whf2qsf.s[38]++;_context4.next=10;return(0,_effects.call)(_api2.default,(0,_apiHelper.deleteCard)(ssoID,payload));case 10:cov_z5whf2qsf.s[39]++;_context4.next=13;return(0,_effects.put)((0,_index.removeCardSuccessful)(payload));case 13:_context4.next=20;break;case 15:_context4.prev=15;_context4.t0=_context4['catch'](2);cov_z5whf2qsf.s[40]++;_context4.next=20;return(0,_effects.call)(_reactNative.Toast.show,'Unable to delete card',_reactNative.Toast.SHORT);case 20:case'end':return _context4.stop();}}},_marked4,this,[[2,15]]);}function getCardToken(_ref11){var name=_ref11.name,number=_ref11.number,expirationDate=_ref11.expirationDate,securityCode=_ref11.securityCode;var cardData,_ref12,_ref13,expirationMonth,expirationYear,tokenResponse,token,fingerprint;return regeneratorRuntime.wrap(function getCardToken$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:cov_z5whf2qsf.f[4]++;cov_z5whf2qsf.s[41]++;_context5.prev=2;cardData=(cov_z5whf2qsf.s[42]++,{name:name,number:number,'security_code':securityCode});_ref12=(cov_z5whf2qsf.s[43]++,expirationDate.split('/')),_ref13=_slicedToArray(_ref12,2),expirationMonth=_ref13[0],expirationYear=_ref13[1];cov_z5whf2qsf.s[44]++;cardData=_extends({},cardData,{'expiration_month':Number(expirationMonth),'expiration_year':Number(expirationYear)});cov_z5whf2qsf.s[45]++;_context5.next=10;return(0,_effects.call)(_api2.default,(0,_apiHelper.tokeniseCard)({card:cardData}));case 10:tokenResponse=_context5.sent;token=(cov_z5whf2qsf.s[46]++,(0,_result2.default)(tokenResponse,'body.id'));fingerprint=(cov_z5whf2qsf.s[47]++,(0,_result2.default)(tokenResponse,'body.card.fingerprint'));cov_z5whf2qsf.s[48]++;return _context5.abrupt('return',{token:token,fingerprint:fingerprint});case 17:_context5.prev=17;_context5.t0=_context5['catch'](2);cov_z5whf2qsf.s[49]++;_context5.next=22;return(0,_effects.call)(_reactNative.Toast.show,'Unable to fetch card token',_reactNative.Toast.SHORT);case 22:cov_z5whf2qsf.s[50]++;throw _context5.t0;case 24:case'end':return _context5.stop();}}},_marked5,this,[[2,17]]);}function fetchPayOtherProducts(action){var _ref14,serviceNo,response,products;return regeneratorRuntime.wrap(function fetchPayOtherProducts$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:cov_z5whf2qsf.f[5]++;cov_z5whf2qsf.s[51]++;_context6.prev=2;_ref14=(cov_z5whf2qsf.s[52]++,action.payload),serviceNo=_ref14.serviceNo;cov_z5whf2qsf.s[53]++;_context6.next=7;return(0,_effects.call)(_api2.default,(0,_apiHelper.getProductFromServiceNo)(serviceNo));case 7:response=_context6.sent;products=(cov_z5whf2qsf.s[54]++,response.body);cov_z5whf2qsf.s[55]++;_context6.next=12;return(0,_effects.put)((0,_index.setPaymentProducts)({serviceNo:serviceNo,products:products}));case 12:cov_z5whf2qsf.s[56]++;if(!(Object.keys(products).length===0)){_context6.next=20;break;}cov_z5whf2qsf.b[8][0]++;cov_z5whf2qsf.s[57]++;_context6.next=18;return(0,_effects.call)(_reactNative.Toast.show,(0,_helper.translate)('PAYMENT_INVALID_SERVICE_NO'),_reactNative.Toast.LONG);case 18:_context6.next=33;break;case 20:cov_z5whf2qsf.b[8][1]++;cov_z5whf2qsf.s[58]++;if(!((cov_z5whf2qsf.b[10][0]++,products.tmhPrepaid)&&(cov_z5whf2qsf.b[10][1]++,products.tmhPrepaid.length>0))){_context6.next=29;break;}cov_z5whf2qsf.b[9][0]++;cov_z5whf2qsf.s[59]++;_context6.next=27;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({routeName:'PayOthersTopUp'}));case 27:_context6.next=33;break;case 29:cov_z5whf2qsf.b[9][1]++;cov_z5whf2qsf.s[60]++;_context6.next=33;return(0,_effects.put)(_reactNavigation.NavigationActions.navigate({routeName:'PayOthersPostpaid'}));case 33:_context6.next=39;break;case 35:_context6.prev=35;_context6.t0=_context6['catch'](2);cov_z5whf2qsf.s[61]++;_reactNative.Toast.show((0,_helper.translate)('PAYMENT_INVALID_SERVICE_NO'),_reactNative.Toast.LONG);case 39:case'end':return _context6.stop();}}},_marked6,this,[[2,35]]);}function payOtherProductToggleCollapseStatus(_ref15){var payload=_ref15.payload;var _ref16,isCollapsed,accountId,billDetailSelector,allBillDetail,selectedBillDetail,billDetail;return regeneratorRuntime.wrap(function payOtherProductToggleCollapseStatus$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:cov_z5whf2qsf.f[6]++;cov_z5whf2qsf.s[62]++;_context7.prev=2;_ref16=(cov_z5whf2qsf.s[63]++,payload),isCollapsed=_ref16.isCollapsed,accountId=_ref16.accountId;billDetailSelector=(cov_z5whf2qsf.s[64]++,(0,_common.getSelector)('payForOthers.billDetail'));cov_z5whf2qsf.s[65]++;_context7.next=8;return(0,_effects.select)(billDetailSelector);case 8:allBillDetail=_context7.sent;selectedBillDetail=(cov_z5whf2qsf.s[66]++,(0,_result2.default)(allBillDetail,''+accountId,null));cov_z5whf2qsf.s[67]++;if(selectedBillDetail){_context7.next=22;break;}cov_z5whf2qsf.b[11][0]++;cov_z5whf2qsf.s[68]++;_context7.next=16;return(0,_effects.call)(_api2.default,(0,_apiHelper.billUsageProductBillDetail)(accountId,false));case 16:billDetail=_context7.sent;cov_z5whf2qsf.s[69]++;_context7.next=20;return(0,_effects.put)((0,_index.setPayOthersProductBillDetail)({data:billDetail.body}));case 20:_context7.next=23;break;case 22:cov_z5whf2qsf.b[11][1]++;case 23:cov_z5whf2qsf.s[70]++;_context7.next=26;return(0,_effects.put)((0,_index.setPayOthersProductCollapseStatus)({isCollapsed:isCollapsed}));case 26:_context7.next=30;break;case 28:_context7.prev=28;_context7.t0=_context7['catch'](2);case 30:case'end':return _context7.stop();}}},_marked7,this,[[2,28]]);}function showPaymentMethods(){var ssoID,res,savedCards;return regeneratorRuntime.wrap(function showPaymentMethods$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:cov_z5whf2qsf.f[7]++;cov_z5whf2qsf.s[71]++;_context8.prev=2;cov_z5whf2qsf.s[72]++;_context8.next=6;return(0,_effects.select)((0,_common.getSelector)('user.profile.uid'));case 6:ssoID=_context8.sent;cov_z5whf2qsf.s[73]++;_context8.next=10;return(0,_effects.call)(_api2.default,(0,_apiHelper.getSavedCards)(ssoID));case 10:res=_context8.sent;savedCards=(cov_z5whf2qsf.s[74]++,(0,_result2.default)(res,'body',[]));cov_z5whf2qsf.s[75]++;_context8.next=15;return(0,_effects.put)((0,_index.setSavedCards)(savedCards));case 15:_context8.next=22;break;case 17:_context8.prev=17;_context8.t0=_context8['catch'](2);cov_z5whf2qsf.s[76]++;_context8.next=22;return(0,_effects.call)(_reactNative.Toast.show,'Unable to get saved cards',_reactNative.Toast.SHORT);case 22:case'end':return _context8.stop();}}},_marked8,this,[[2,17]]);}function paymentSaga(){return regeneratorRuntime.wrap(function paymentSaga$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:cov_z5whf2qsf.f[8]++;cov_z5whf2qsf.s[77]++;_context9.next=4;return(
(0,_effects.takeLatest)(_index.SHOW_PAYMENT_METHODS,showPaymentMethods));case 4:cov_z5whf2qsf.s[78]++;_context9.next=7;return(
(0,_effects.takeLatest)(_index.PAY_NEW_CUSTOMER,paymentForNewCustomer));case 7:cov_z5whf2qsf.s[79]++;_context9.next=10;return(
(0,_effects.takeLatest)(_index.PAY_EXISTING_CUSTOMER,paymentForExistingCustomer));case 10:cov_z5whf2qsf.s[80]++;_context9.next=13;return(
(0,_effects.takeLatest)(_index.PRE_LOGIN_PAYMENT,paymentForNonLoginUser));case 13:cov_z5whf2qsf.s[81]++;_context9.next=16;return(
(0,_effects.takeLatest)(_index.REMOVE_EXISTING_CARD,removeExisingCard));case 16:cov_z5whf2qsf.s[82]++;_context9.next=19;return(
(0,_effects.takeLatest)(_index.GET_PRODUCTS_PAYMENT,fetchPayOtherProducts));case 19:cov_z5whf2qsf.s[83]++;_context9.next=22;return(
(0,_effects.takeLatest)(_index.TOGGLE_PAYOTHERS_PRODUCT_COLLAPSE_STATUS,payOtherProductToggleCollapseStatus));case 22:case'end':return _context9.stop();}}},_marked9,this);}